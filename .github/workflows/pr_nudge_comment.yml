name: PR Nudge Comment
on:
  pull_request_target:
    types: [opened]

jobs:
  nudge:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            const pr = context.payload.pull_request;

            // Ekki nudga ef PR er draft
            if (pr.draft) return;

            const body = (pr.body || "").toLowerCase();

            // Leitum bara aÃ° Ã¾essum tveimur spurningum Ã­ PR-lÃ½singunni
            const must = ["uppfyllir atriÃ°iÃ° matskvarÃ°a", "er textinn lÃ¦silegur og rÃ©ttur"];
            const missing = must.filter(k => !body.includes(k));

            if (missing.length === 0) return;

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: pr.number,
              body: [
                `ğŸ‘‹ HÃ¦ ${pr.user.login}!`,
                `Vinsamlegast fylltu Ãºt PR sjÃ¡lfsmat Ã­ lÃ½singunni (vantar: **${missing.join(", ")}**).`,
                ``,
                `ğŸ’¬ Mundu einnig aÃ° skrifa **HvaÃ° mÃ¡ betur fara** Ã­ *Comment*-sviÃ°inu hÃ©r fyrir neÃ°an.`,
              ].join('\n')
            });
